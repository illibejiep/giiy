### Giiy

Это CRUD&Model-генератор основаный на giix и bootstrap-gii. Непонятный, запунанный, содержащий гетерогенный код и даже php-шаблоны гетерогенного кода, что делает его поддержку немыслемой.
Тем не менее имеет следующюю структуру:

	giiy/
	    assets/
	        js/
                modelForm.js - js для modelForm
        giiyCrud/ - CRUD-генератор
        giiyModel/ - Model-генератор
        helpers/ - Хелперы, оставшиеся от giix
	    interfaces/ - папка с описаниями интерфейсов
            IFileBased.php - модель, использующая или представляющая файл
            Iillustrated.php - модель с картинкой
            ITypeEnumerable.php - модель имеющая тип, описываемый классом {modelName}TypeEnum
        widgets/
            ModelFileUpload/
                views/
                    file.php - вьюха виджета ModelFileUpload
                ModelFileUpload.php - виджет файла
            ModelForm.php - компонент форм (расширение TbActiveForm)
        GiiyCRUDController.php - базовый класс для контроллеров бэкэнда
        GiiyActiveRecord.php - расширение класса CActiveRecord содержащий вспомогательные методы.

##### CRUD + Upload.
CRUD-контроллеры наследуются от общего класса **CDURController**, в котором реализованы экшены **Create**, **Reade**, **Update**, **Delete** и **Upload**. Для AJAX-запросов возвращатся JSON. Экшен **Upload** используется только для моделей, реализующих интерфейс **IFileBased**. CRUD-контроллеры используют виджет **ModelForm** - расширенный **TbActiveForm**.
Новые методы виджета формы:

* **enum($attribute)** - значения из {ModelName}{AttributeName}Enum класса.
* **params()** - поле с набором динамических параметров модели.
* **date($attribute),time($attribute),datetime($attribute)** - 'date','time','datetime' pickers
* **elementTypes($attribute)** - Костыльный виджет для MANY_TO_MANY связей с {ModelName}TypeEnum классом.
* **tags($attribute)** - Список знёачений, с текстовыми разделителями.
* **editor($attribute)** - ckeditor.
* **relation($attribute)** - связанные модели.
* **relationForm($attribute)** - связанные модели с формой для их редактирования.
* **input($attribute)** - текстовое поле.
* **text($attribute)** - textarea.
* **check($attribute)** - checkbox.
* **submitButton()** - submit button.

Методы TbActiveForm работают, но последствия не известны.
В CRUD-контроллерах есть экшин Form, используемый методом relationForm для отображения формы создания и редактирования связанных моделей. Он отрисовывает форму на пустом лейауте и принимает 2 параметра: id модели и название модели, для релейшина которой отрисовывается форма.

##### Модели.

Модели насделются от класса ActiveRecord, в котором подключается **EActiveRecordRelationBehavior**, реализованны методы JSON-сериализации, created-modified и вспомогательные методы.

##### JSON-сериализация.

ActiveRecord реализует интерфейс JsonSerializable. Для JSON-данных модели формируются дополнительные поля:

* **_modelName** - имя класса модели.
* **_viewName** - отображаемое имя модели.
* **_picture** - url-адрес изображения модели.
* **_url** - url-адрес модели.

##### Вспомогательные методы.

* **getRelationNames($relationName,$asTable)** - возвращает массив id => name для релейшина $relationName. Если параметр $asTable = true, то возвращает таблицу с данными релейшина.
* **getRelationIds($relationName)** - возвращает массив первичных ключей решейшина.
* **toArray()** - преобразует данные модели в массив с дополнительными полями.

##### Кодогенератор.

Используемые модели наследуются от сгенерированных, чтобы их перегенерация не затирала имеющийся функционал.
Если файла модели нет, то он создается автоматически. CRUD-генератор создает контроллеры, только если они отсутсвуют. Вьюхи делятся на базовые, которые перезаписываются генератором, и основные, которые создаются только при их отсутствии и подключают базовые файлы.

    application/
        models/ - папка, содержащая сгенерированные модели и классы
            _base/ - сгенерированные классы моделей (перезаписываются)
            enum/ - сгенерированные enum-классы (только создаются)
            {modelName}.php - сгенерированные классы моделей, наследующиеся от базовых (только создаются)
        views/
            {modelName}/
                _base/ - папка сгенерированных шаблонов (по умолчанию подключаются в основных)
                    admin.php - шаблон с датагридом
                    create.php - шаблон создания модели
                    form.php - шаблон формы
                    index.php - не задействован (может быть чем угодно)
                    update.php - обновление
                    view.php - просмотр модели
                admin.php - шаблон с датагридом
                create.php - шаблон создания модели
                form.php - шаблон формы
                index.php - не задействован (может быть чем угодно)
                update.php - обновление
                view.php - просмотр модели